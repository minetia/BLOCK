<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>THE BLOCK 4: REALITY (FIXED)</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #1a1814;
            --term-green: #4af626;
            --term-amber: #ffb000;
            --alert: #ff3333;
            --scanline: rgba(0,0,0,0.5);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; }
        
        body { 
            background-color: var(--bg); color: var(--term-green); 
            font-family: 'VT323', monospace; font-size: 1.5rem;
            height: 100vh; overflow: hidden; display: flex; flex-direction: column;
        }

        /* ğŸ“º ì˜¬ë“œ í„°ë¯¸ë„ íš¨ê³¼ */
        body::before {
            content: " "; display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 999; background-size: 100% 2px, 3px 100%; pointer-events: none;
        }
        
        @keyframes flicker { 0% { opacity: 0.9; } 50% { opacity: 1.0; } 100% { opacity: 0.9; } }
        body { animation: flicker 0.2s infinite; }

        /* ìƒíƒœë°” */
        .hud {
            padding: 15px; border-bottom: 2px solid var(--term-green);
            display: flex; justify-content: space-between; font-size: 1.2rem;
            background: #000; z-index: 100;
        }
        .energy-bar { color: var(--term-amber); }

        /* ë©”ì¸ ìŠ¤í¬ë¦° */
        .screen {
            flex: 1; padding: 20px; overflow-y: auto; display: none; flex-direction: column;
            align-items: center; justify-content: center; text-align: left; z-index: 10;
        }
        .screen.active { display: flex; }

        .log-box {
            width: 100%; max-width: 600px; text-align: left; margin-bottom: 20px;
            color: #ccc; font-size: 1.2rem; line-height: 1.4;
        }
        .highlight { color: var(--term-green); font-weight: bold; }
        .warning { color: var(--alert); }

        /* ë ˆíŠ¸ë¡œ ë²„íŠ¼ */
        .btn {
            background: #000; border: 2px solid var(--term-green); color: var(--term-green);
            padding: 10px 20px; font-family: 'VT323'; font-size: 1.4rem; cursor: pointer;
            margin: 5px; width: 100%; max-width: 300px; text-transform: uppercase;
        }
        .btn:hover { background: var(--term-green); color: #000; }

        /* í‚¤íŒ¨ë“œ */
        .keypad { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; margin-top: 10px; }
        .key { border: 1px solid var(--term-amber); color: var(--term-amber); padding: 10px; text-align: center; cursor: pointer; width: 60px; }
        .key:hover { background: var(--term-amber); color: #000; }
        .key:active { transform: scale(0.95); }

        /* ëª¨ë˜í­í’ íš¨ê³¼ */
        .sandstorm {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: transparent;
            opacity: 0.1; pointer-events: none; z-index: 50;
        }
    </style>
</head>
<body>

    <div class="sandstorm"></div>

    <div class="hud">
        <div>LOC: SECTOR_7</div>
        <div class="energy-bar">BATTERY: <span id="bat-val">100</span>%</div>
    </div>

    <div id="scene-1" class="screen active">
        <div class="log-box">
            > SYSTEM REBOOT... OK.<br>
            > DATE: 2048-??-??<br>
            > STATUS: <span class="warning">CRITICAL</span><br><br>
            ë‹¹ì‹ ì€ ìº¡ìŠì—ì„œ ëˆˆì„ ë–´ìŠµë‹ˆë‹¤. <br>
            ë©”íƒ€ë²„ìŠ¤ì˜ í™”ë ¤í•¨ì€ ì—†ìŠµë‹ˆë‹¤. <br>
            ëª¨ë˜ë°”ëŒ ì†Œë¦¬ì™€ ê¸°ê³„ìŒë§Œ ë“¤ë¦½ë‹ˆë‹¤.
        </div>
        <button class="btn" onclick="game.move('scene-2')">ì£¼ë³€ì„ ìˆ˜ìƒ‰í•œë‹¤ (-10%)</button>
    </div>

    <div id="scene-2" class="screen">
        <div class="log-box">
            êµ¬ì„ì—ì„œ ë°±ê³¨ì´ ëœ ì‹œì²´ë¥¼ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.<br>
            ì†ì—ëŠ” ë‚¡ì€ <span class="highlight">[ì½œë“œ ì›”ë ›]</span>ì´ ì¥ì–´ì ¸ ìˆìŠµë‹ˆë‹¤.<br>
            ì €í•­êµ°ì˜ ì¢Œí‘œê°€ ë“¤ì–´ìˆì„ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤.
        </div>
        <button class="btn" onclick="game.startHack()">ë¹„ë°€ë²ˆí˜¸ í•´ë… ì‹œë„ (-20%)</button>
        <button class="btn" onclick="game.move('scene-3')">ë¬´ì‹œí•˜ê³  ì´ë™í•œë‹¤ (-10%)</button>
    </div>

    <div id="scene-hack" class="screen">
        <div class="log-box">
            > PROTOCOL: DECRYPT<br>
            > PASSWORD: 3 DIGITS (000-999)<br>
            > HINT: <span id="hint-msg" class="highlight">ì…ë ¥ ëŒ€ê¸° ì¤‘...</span>
        </div>
        <div style="font-size:2rem; margin:10px; color:var(--term-amber);" id="input-display">_ _ _</div>
        <div class="keypad">
            <div class="key" onclick="game.inputKey(1)">1</div><div class="key" onclick="game.inputKey(2)">2</div><div class="key" onclick="game.inputKey(3)">3</div>
            <div class="key" onclick="game.inputKey(4)">4</div><div class="key" onclick="game.inputKey(5)">5</div><div class="key" onclick="game.inputKey(6)">6</div>
            <div class="key" onclick="game.inputKey(7)">7</div><div class="key" onclick="game.inputKey(8)">8</div><div class="key" onclick="game.inputKey(9)">9</div>
            <div class="key" onclick="game.clearKey()">C</div><div class="key" onclick="game.inputKey(0)">0</div><div class="key" onclick="game.checkKey()">ENT</div>
        </div>
    </div>

    <div id="scene-3" class="screen">
        <div class="log-box">
            <span class="warning">WARNING: DRONE DETECTED</span><br><br>
            ì˜¤ìƒë¬´ì˜ ê°ì‹œ ë“œë¡ ì´ ìˆœì°° ì¤‘ì…ë‹ˆë‹¤.<br>
            ë°°í„°ë¦¬ê°€ ì–¼ë§ˆ ë‚¨ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
        </div>
        <button class="btn" onclick="game.ending('bad')">ì‹¸ìš´ë‹¤ (ìŠ¹ë¥  10%)</button>
        <button class="btn" onclick="game.ending('good')">ì£½ì€ ì²™í•œë‹¤ (ì—ë„ˆì§€ ì ˆì•½)</button>
    </div>

    <div id="scene-end" class="screen">
        <h1 id="end-title" style="font-size:3rem; margin-bottom:20px;"></h1>
        <div id="end-desc" class="log-box" style="text-align:center;"></div>
        <button class="btn" onclick="location.reload()">RESTART SIMULATION</button>
    </div>

    <script>
        class WastelandGame {
            constructor() {
                this.battery = 100;
                this.passcode = Math.floor(Math.random() * 999);
                this.currentInput = "";
                this.tryCount = 5;
            }

            // ì¥ë©´ ì´ë™ (ë°°í„°ë¦¬ ì†Œëª¨)
            move(id) {
                this.battery -= 10;
                this.updateBat();
                
                if(this.battery <= 0) {
                    this.ending('dead');
                } else {
                    this.show(id);
                }
            }

            show(id) {
                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                document.getElementById(id).classList.add('active');
            }

            updateBat() {
                const el = document.getElementById('bat-val');
                if(el) {
                    el.innerText = this.battery;
                    if(this.battery < 30) el.style.color = 'var(--alert)';
                }
            }

            // í•´í‚¹ ì‹œì‘
            startHack() {
                this.battery -= 20; 
                this.updateBat();
                
                if(this.battery <= 0) {
                    this.ending('dead');
                } else {
                    this.show('scene-hack');
                }
            }

            // í‚¤íŒ¨ë“œ ì…ë ¥
            inputKey(num) {
                if(this.currentInput.length < 3) this.currentInput += num.toString();
                this.updateDisplay();
            }
            clearKey() { this.currentInput = ""; this.updateDisplay(); }
            updateDisplay() { document.getElementById('input-display').innerText = this.currentInput.padEnd(3, '_'); }

            // ì •ë‹µ í™•ì¸
            checkKey() {
                if(this.currentInput.length !== 3) return;
                
                const val = parseInt(this.currentInput);
                const hint = document.getElementById('hint-msg');
                
                if(val === this.passcode) {
                    hint.innerText = "ACCESS GRANTED.";
                    hint.style.color = "var(--term-green)";
                    setTimeout(() => {
                        alert("ì¢Œí‘œ íšë“: ì €í•­êµ° ê¸°ì§€ (SECTOR 9)");
                        this.move('scene-3');
                    }, 500);
                } else {
                    this.tryCount--;
                    if(this.tryCount <= 0) {
                        alert("ë³´ì•ˆ ì‹œìŠ¤í…œ ì‘ë™! ë‹¨ë§ê¸°ê°€ í­ë°œí–ˆìŠµë‹ˆë‹¤.");
                        this.battery -= 30; // í­ë°œ ë°ë¯¸ì§€
                        this.move('scene-3');
                    } else {
                        if(val < this.passcode) hint.innerText = `UP (ê¸°íšŒ ${this.tryCount}ë²ˆ)`;
                        else hint.innerText = `DOWN (ê¸°íšŒ ${this.tryCount}ë²ˆ)`;
                        hint.style.color = "var(--alert)";
                        this.currentInput = "";
                        this.updateDisplay();
                    }
                }
            }

            // ì—”ë”© ì²˜ë¦¬
            ending(type) {
                this.show('scene-end');
                const title = document.getElementById('end-title');
                const desc = document.getElementById('end-desc');

                if(type === 'dead') {
                    title.innerText = "ENERGY DEPLETED";
                    title.style.color = "var(--alert)";
                    desc.innerText = "ë°°í„°ë¦¬ê°€ ë°©ì „ë˜ì—ˆìŠµë‹ˆë‹¤.\në‹¹ì‹ ì€ ì‚¬ë§‰ì˜ ì¼ë¶€ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.";
                } else if(type === 'bad') {
                    title.innerText = "ELIMINATED";
                    title.style.color = "var(--alert)";
                    desc.innerText = "ë“œë¡ ì˜ ë ˆì´ì €ì— ê´€í†µë‹¹í–ˆìŠµë‹ˆë‹¤.\nì¸ê°„ì˜ ëª¸ìœ¼ë¡œëŠ” ê¸°ê³„ë¥¼ ì´ê¸¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
                } else {
                    title.innerText = "SURVIVOR";
                    title.style.color = "var(--term-green)";
                    desc.innerHTML = "ë“œë¡ ì´ ë‹¹ì‹ ì„ ì¸ì‹í•˜ì§€ ëª»í•˜ê³  ì§€ë‚˜ê°‘ë‹ˆë‹¤.<br>ì €í•­êµ°ì˜ ì‹ í˜¸ê°€ ì¡í™ë‹ˆë‹¤.<br><br><strong>[TO BE CONTINUED IN FINAL BATTLE]</strong>";
                }
            }
        }

        // [ì¤‘ìš”] ê²Œì„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì „ì—­ ë³€ìˆ˜ë¡œ ì„ ì–¸ (ë²„ê·¸ ìˆ˜ì •)
        window.game = new WastelandGame();
    </script>
</body>
</html>
