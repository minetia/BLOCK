<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>THE BLOCK 2: REVENGE (FIXED)</title>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Black+Han+Sans&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #000;
            --bug-color: #00ff00; /* í•´ì»¤ ê·¸ë¦° */
            --sys-color: #ff0055; /* ì‹œìŠ¤í…œ ë ˆë“œ */
            --glitch-text: #fff;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background-color: var(--bg); color: var(--glitch-text); 
            font-family: 'Share Tech Mono', monospace;
            height: 100vh; overflow: hidden; display: flex; flex-direction: column;
        }

        /* ğŸ“º ê¹¨ì§„ í™”ë©´ íš¨ê³¼ */
        body::before {
            content: " "; display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 999; background-size: 100% 2px, 3px 100%; pointer-events: none;
        }

        /* ê³µí†µ ìŠ¤í¬ë¦° */
        .screen {
            position: absolute; width: 100%; height: 100%; padding: 20px;
            display: none; flex-direction: column; justify-content: center; align-items: center;
            text-align: center; transition: 0.5s; z-index: 10;
        }
        .screen.active { display: flex; animation: noise 0.2s steps(2); }

        h1 { font-family: 'Black Han Sans', sans-serif; font-size: 3rem; color: var(--bug-color); text-shadow: 2px 2px var(--sys-color); margin-bottom: 20px; }
        p { font-size: 1.2rem; line-height: 1.5; margin-bottom: 30px; max-width: 600px; }

        /* ë²„íŠ¼ */
        .btn {
            background: #000; border: 2px solid var(--bug-color); color: var(--bug-color);
            padding: 15px 30px; font-size: 1.2rem; cursor: pointer; font-family: 'Share Tech Mono';
            box-shadow: 5px 5px 0px var(--bug-color); transition: 0.1s; margin: 10px;
        }
        .btn:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0px var(--bug-color); }
        .btn-sys { border-color: var(--sys-color); color: var(--sys-color); box-shadow: 5px 5px 0px var(--sys-color); }
        .btn-sys:active { box-shadow: 2px 2px 0px var(--sys-color); }

        /* SCENE 1: ì°¨íŠ¸ í•´í‚¹ */
        .chart-overlay {
            position: absolute; width: 100%; height: 300px; pointer-events: none;
            display: flex; justify-content: center; align-items: center; font-size: 5rem;
            color: rgba(255, 0, 0, 0.5); font-weight: bold; z-index: 20;
        }
        .hacking-bar { width: 100%; height: 10px; background: #333; margin-top: 10px; }
        .hacking-progress { width: 0%; height: 100%; background: var(--bug-color); transition: width 0.1s; }

        /* SCENE 2: ì½”ë“œ ë°°í‹€ */
        .code-box {
            width: 100%; max-width: 500px; height: 150px; background: #111; border: 1px solid #333;
            color: var(--bug-color); padding: 10px; text-align: left; overflow-y: auto; font-size: 0.9rem;
            margin-bottom: 20px; white-space: pre-wrap;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes noise { 0% { transform: translate(0,0) } 20% { transform: translate(-2px,2px) } 40% { transform: translate(-2px,-2px) } 60% { transform: translate(2px,2px) } 80% { transform: translate(2px,-2px) } 100% { transform: translate(0,0) } }
        .shake { animation: noise 0.5s infinite; }
    </style>
</head>
<body>

    <div id="intro" class="screen active">
        <h1>SYSTEM REBOOT...</h1>
        <p style="color:#555">Version 2.6 Loaded.</p>
        <p>ê¸°ì–µì´ ëŒì•„ì™”ë‹¤.<br>ë‚˜ëŠ” íŠ¸ë ˆì´ë”ê°€ ì•„ë‹ˆë‹¤.<br>ë‚˜ëŠ” ì´ ì‹œìŠ¤í…œì˜ <strong>'ì˜¤ë¥˜(BUG)'</strong>ë‹¤.</p>
        <button class="btn" onclick="game.start()">ì‹œìŠ¤í…œ ì¹¨íˆ¬ (INJECT)</button>
    </div>

    <div id="scene-1" class="screen">
        <h2 style="color:var(--sys-color)">WARNING: ABNORMAL ACTIVITY</h2>
        <div style="position:relative; width:100%;">
            <div id="chart-msg" class="chart-overlay"></div>
            <div id="chart-container" style="height:300px;"></div>
        </div>
        <p>ì„¤ê³„ìê°€ ê°€ê²©ì„ í­ë½ì‹œí‚¤ë ¤ í•œë‹¤.<br><strong>[GLITCH]</strong> ë²„íŠ¼ì„ ì—°íƒ€í•´ì„œ ì°¨íŠ¸ë¥¼ ë©ˆì¶°ë¼!</p>
        
        <div class="hacking-bar"><div id="glitch-bar" class="hacking-progress"></div></div>
        
        <button class="btn" id="glitch-btn" onclick="game.useGlitch()">GLITCH (TAP FAST!)</button>
    </div>

    <div id="scene-2" class="screen">
        <h2 style="color:var(--bug-color)">FIREWALL DETECTED</h2>
        <div id="terminal" class="code-box">Connecting to Core...<br>> Access Denied.<br>> Security Protocol V.9 Activated.</div>
        <p>ë³´ì•ˆ ì½”ë“œê°€ ë³€ê²½ë˜ì—ˆë‹¤. ì˜¬ë°”ë¥¸ ëª…ë ¹ì–´ë¥¼ ì„ íƒí•˜ë¼.</p>
        
        <div id="quiz-area">
            <button class="btn btn-sys" onclick="game.wrongAnswer()">SUDO DELETE USER</button>
            <button class="btn" onclick="game.correctAnswer()">ROOT ACCESS_OVERRIDE</button>
        </div>
    </div>

    <div id="scene-3" class="screen">
        <h1 style="color:#fff; font-size:2rem;">THE ARCHITECT</h1>
        <p>"ëˆì§ˆê¸°êµ°. í•˜ì§€ë§Œ ì´ ì„¸ê³„ëŠ” ë‚´ ê²ƒì´ë‹¤.<br>ì‚­ì œ(Delete) ë²„íŠ¼ í•˜ë‚˜ë©´ ë„ˆëŠ” ëì´ì•¼."</p>
        <br>
        <div style="display:flex; flex-direction:column; gap:15px;">
            <button class="btn btn-sys" onclick="game.ending('bad')">ì‚­ì œë¥¼ ë°›ì•„ë“¤ì¸ë‹¤ (GAME OVER)</button>
            <button class="btn" onclick="game.ending('true')">ì‹œìŠ¤í…œì„ ê³¼ë¶€í•˜ ì‹œí‚¨ë‹¤ (CRASH)</button>
        </div>
    </div>

    <div id="end" class="screen">
        <h1 class="shake">FATAL ERROR</h1>
        <p>404 NOT FOUND<br>SYSTEM CRASHED</p>
        <p style="color:var(--bug-color)">"ì´ì œ... ìš°ë¦¬ ëª¨ë‘ ììœ ì•¼."</p>
        <button class="btn" onclick="location.href='metaverse_game.html'">ENTER NEW WORLD (V.3.0)</button>
    </div>

    <script>
        // íŠ¸ë ˆì´ë”©ë·° ìœ„ì ¯ ë¡œë“œ ì‹œë„
        try {
            new TradingView.widget({
                "autosize": true, "symbol": "BINANCE:BTCUSDT", "interval": "1", "theme": "dark",
                "style": "1", "locale": "kr", "toolbar_bg": "#000", "enable_publishing": false,
                "hide_top_toolbar": true, "hide_legend": true, "container_id": "chart-container"
            });
        } catch(e) {}

        class SequelGame {
            constructor() {
                this.glitchPower = 0;
            }

            next(id) {
                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                document.getElementById(id).classList.add('active');
            }

            start() { this.next('scene-1'); }

            // Scene 1: ì°¨íŠ¸ ë©ˆì¶”ê¸° ë¯¸ë‹ˆê²Œì„
            useGlitch() {
                this.glitchPower += 8; // í´ë¦­ë‹¹ ì¦ê°€ëŸ‰
                if(this.glitchPower > 100) this.glitchPower = 100;
                
                document.getElementById('glitch-bar').style.width = this.glitchPower + '%';
                
                // ì‹œê° íš¨ê³¼
                const msg = document.getElementById('chart-msg');
                msg.innerText = "ERROR";
                msg.style.opacity = 1;
                setTimeout(() => msg.style.opacity = 0, 100);

                if(this.glitchPower >= 100) {
                    alert("ì°¨íŠ¸ ë™ê²° ì„±ê³µ! ê´€ë¦¬ì ê¶Œí•œ íƒˆì·¨.");
                    this.next('scene-2');
                }
            }

            // Scene 2: í€´ì¦ˆ
            wrongAnswer() {
                const term = document.getElementById('terminal');
                term.innerHTML += "\n> COMMAND FAILED. SYSTEM LOCKED.";
                term.scrollTop = term.scrollHeight;
                document.body.classList.add('shake');
                setTimeout(() => {
                    document.body.classList.remove('shake');
                    alert("ë³´ì•ˆ ì‹œìŠ¤í…œì— ë°œê°ë˜ì—ˆìŠµë‹ˆë‹¤. (ì¬ì‹œì‘)");
                    location.reload();
                }, 500);
            }

            correctAnswer() {
                const term = document.getElementById('terminal');
                term.innerHTML += "\n> ACCESS GRANTED.\n> WELCOME, ADMIN.";
                term.scrollTop = term.scrollHeight;
                setTimeout(() => this.next('scene-3'), 1000);
            }

            // Scene 3: ì—”ë”© ë¶„ê¸°
            ending(type) {
                if(type === 'bad') {
                    alert("ë‹¹ì‹ ì€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
                    location.reload();
                } else {
                    // í™”ì´íŠ¸ ì•„ì›ƒ íš¨ê³¼
                    document.body.style.background = "white"; 
                    document.querySelectorAll('*').forEach(el => el.style.opacity = 0);
                    
                    setTimeout(() => {
                        document.body.style.background = "black";
                        document.querySelectorAll('*').forEach(el => el.style.opacity = 1);
                        this.next('end');
                    }, 1000);
                }
            }
        }

        // ì „ì—­ ë³€ìˆ˜ë¡œ ì„ ì–¸
        window.game = new SequelGame();
    </script>
</body>
</html>
