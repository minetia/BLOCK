<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>THE BLOCK: NEW GOD (FINAL FIX)</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Sans+KR:wght@300;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0b0f19;
            --gold: #d4af37;
            --red: #ff3b30;
            --green: #4cd964;
            --glass: rgba(20, 20, 30, 0.95);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background: var(--bg); color: #fff; 
            font-family: 'Noto Sans KR', sans-serif;
            height: 100vh; overflow: hidden; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }

        /* 매뉴얼 버튼 */
        .manual-btn {
            position: fixed; top: 15px; right: 15px; z-index: 10000;
            background: rgba(0, 0, 0, 0.8); color: #fff; text-decoration: none;
            padding: 8px 15px; border: 1px solid #fff; border-radius: 4px;
            font-family: sans-serif; font-size: 12px; font-weight: bold;
        }

        /* 신의 시점 배경 */
        .god-view {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            background: radial-gradient(circle at center, #1a2a40 0%, #000 100%);
            z-index: -1; display: flex; align-items: center; justify-content: center;
        }
        .earth {
            width: 300px; height: 300px; border-radius: 50%;
            background: conic-gradient(#1e3c72, #2a5298, #1e3c72);
            box-shadow: 0 0 100px rgba(42, 82, 152, 0.5);
            opacity: 0.8; animation: rotateEarth 30s linear infinite;
        }

        /* 패널 공통 */
        .control-panel {
            width: 90%; max-width: 500px; background: var(--glass);
            border: 1px solid var(--gold); border-radius: 12px;
            padding: 25px; text-align: center; box-shadow: 0 0 50px rgba(212, 175, 55, 0.2);
            backdrop-filter: blur(10px); 
            display: none; /* 기본 숨김 */
            flex-direction: column; gap: 20px;
            z-index: 10;
        }
        /* active 클래스는 JS에서 display: flex로 제어 */

        h1 { font-family: 'Cinzel', serif; color: var(--gold); font-size: 2.2rem; margin-bottom: 5px; text-shadow: 0 0 15px var(--gold); }
        .subtitle { font-size: 0.9rem; color: #aaa; letter-spacing: 4px; margin-bottom: 20px; text-transform: uppercase; }

        /* 버튼 스타일 */
        .btn-group { display: flex; gap: 15px; justify-content: center; width: 100%; }
        .god-btn {
            flex: 1; padding: 18px; font-size: 1.1rem; font-weight: bold; border: none;
            cursor: pointer; transition: 0.1s; border-radius: 8px; color: #fff;
            font-family: 'Cinzel', serif; box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            position: relative; overflow: hidden;
        }
        .btn-start { background: #fff; color: #000; font-weight: 900; border: 2px solid var(--gold); }
        .btn-pump { background: linear-gradient(180deg, #4cd964, #2c8c3e); border-bottom: 4px solid #1e662a; }
        .btn-dump { background: linear-gradient(180deg, #ff3b30, #c41c12); border-bottom: 4px solid #8a0f08; }
        
        .god-btn:active { transform: scale(0.95); border-bottom-width: 0; margin-top: 4px; }

        /* 채팅창 */
        .ant-chat {
            height: 160px; background: rgba(0,0,0,0.6); border: 1px solid #444; border-radius: 8px;
            overflow: hidden; text-align: left; padding: 15px; font-size: 0.9rem;
            display: flex; flex-direction: column; justify-content: flex-end;
        }
        .msg { margin-bottom: 6px; text-shadow: 0 1px 2px #000; }
        .msg.cry { color: #ff6b6b; }
        .msg.cheer { color: #69f0ae; }
        .msg.new { animation: slideUp 0.3s ease-out; }

        .price-display { font-size: 3.5rem; font-weight: bold; font-family: 'Cinzel'; transition: color 0.2s; margin: 10px 0; }
        
        /* 엔딩 경고창 */
        .challenger-alert {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 999; 
            display: none; 
            flex-direction: column; justify-content: center; align-items: center;
        }
        .alert-box { 
            border: 4px solid var(--red); padding: 40px; text-align: center; 
            background: #000; box-shadow: 0 0 50px var(--red);
            animation: pulse 0.8s infinite; max-width: 90%;
        }

        @keyframes rotateEarth { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0% { box-shadow: 0 0 20px var(--red); transform: scale(1); } 50% { box-shadow: 0 0 60px var(--red); transform: scale(1.02); } 100% { box-shadow: 0 0 20px var(--red); transform: scale(1); } }
        .shake { animation: shakeBody 0.3s; }
        @keyframes shakeBody { 0% { transform: translate(0,0) } 25% { transform: translate(-5px, 5px) } 50% { transform: translate(5px, -5px) } 75% { transform: translate(-5px, 5px) } 100% { transform: translate(0,0) } }

    </style>
</head>
<body>

    <a href="manual.html" target="_blank" class="manual-btn"><i class="fas fa-book"></i> MANUAL</a>
    
    <div class="god-view"><div class="earth"></div></div>

    <div id="intro" class="control-panel" style="display:flex;">
        <h1>SUCCESSION</h1>
        <p class="subtitle">THE NEW ARCHITECT</p>
        <p style="margin-bottom:20px; line-height:1.6;">
            오상무가 제거되었습니다.<br>
            이제 <span style="color:var(--gold); font-weight:bold; font-size:1.2rem;">당신</span>이<br>이 세계의 새로운 신입니다.
        </p>
        <button class="god-btn btn-start" onclick="game.start()">의자에 앉기 (START)</button>
    </div>

    <div id="main" class="control-panel">
        <h1>THE THRONE</h1>
        <div class="subtitle">MASTER CONTROL</div>

        <div class="price-display" id="price">BTC 98K</div>
        
        <div class="ant-chat" id="chat-box">
            <div class="msg" style="color:#aaa;">SYSTEM: 관리자 권한 승인됨.</div>
            <div class="msg" style="color:#aaa;">SYSTEM: 시장 조작 모듈 활성화.</div>
        </div>

        <div class="btn-group">
            <button class="god-btn btn-pump" onclick="game.manipulate('PUMP')">PUMP (폭등)</button>
            <button class="god-btn btn-dump" onclick="game.manipulate('DUMP')">DUMP (폭락)</button>
        </div>
        
        <p style="font-size:0.8rem; color:#888; margin-top:15px;">
            <i class="fas fa-exclamation-triangle"></i> 경고: 과도한 조작은 시스템을 불안정하게 합니다.
        </p>
    </div>

    <div id="ending" class="challenger-alert">
        <div class="alert-box">
            <h1 style="color:var(--red); font-size:3rem;">WARNING</h1>
            <p style="font-size:1.5rem; margin:20px 0; color:#fff;">NEW CHALLENGER</p>
            <div style="font-size:1.2rem; margin-bottom:30px;">
                ID: <span style="color:var(--gold); font-weight:bold;">PLAYER_ONE</span>
            </div>
            <p style="color:#aaa; font-size:1rem; margin-bottom:30px;">
                "과거의 당신과 똑같은 눈을 한 녀석이군..."<br>
                이제 당신이 사냥당할 차례입니다.
            </p>
            <button class="god-btn" style="background:var(--red); width:100%;" onclick="location.reload()">운명 받아들이기 (LOOP)</button>
        </div>
    </div>

    <script>
        class GodMode {
            constructor() {
                this.price = 98000;
                this.clickCount = 0;
                this.maxClicks = 5; // 5번 클릭 시 엔딩
                this.msgs = {
                    pump: ["가즈아!!", "대출 풀매수!", "갓비트 찬양해!", "팬티 벗고 소리 질러!", "형님 감사합니다!"],
                    dump: ["아악! 내 돈!", "한강 물 차갑냐?", "살려주세요...", "청산당했습니다.", "이건 사기야!"]
                };
            }

            // [핵심 수정] CSS 클래스가 아닌 style.display로 강제 전환
            start() {
                // 인트로 숨기기
                document.getElementById('intro').style.display = 'none';
                
                // 메인 화면 보이기
                const main = document.getElementById('main');
                main.style.display = 'flex';
                // 페이드인 효과
                main.style.animation = 'slideUp 0.5s ease-out';
            }

            manipulate(type) {
                this.clickCount++;
                
                document.body.classList.add('shake');
                setTimeout(() => document.body.classList.remove('shake'), 300);

                const chatBox = document.getElementById('chat-box');
                const priceDisplay = document.getElementById('price');

                let change = Math.floor(Math.random() * 8000) + 2000;
                if(type === 'DUMP') change *= -1;
                this.price += change;
                
                priceDisplay.innerText = `$${this.price.toLocaleString()}`;
                priceDisplay.style.color = type === 'PUMP' ? 'var(--green)' : 'var(--red)';

                for(let i=0; i<2; i++) { 
                    const txt = this.msgs[type.toLowerCase()][Math.floor(Math.random() * this.msgs[type.toLowerCase()].length)];
                    const div = document.createElement('div');
                    div.className = `msg ${type === 'PUMP' ? 'cheer' : 'cry'} new`;
                    div.innerText = `User${Math.floor(Math.random()*999)}: ${txt}`;
                    chatBox.appendChild(div);
                }
                chatBox.scrollTop = chatBox.scrollHeight;

                if(this.clickCount >= this.maxClicks) {
                    setTimeout(() => {
                        document.getElementById('ending').style.display = 'flex';
                    }, 800);
                }
            }
        }

        // 전역 변수 선언 (확실한 실행 보장)
        window.game = new GodMode();
    </script>
</body>
</html>
